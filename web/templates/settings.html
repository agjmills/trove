{{define "content"}}
<div class="flex gap-0 min-h-[calc(100vh-80px)] bg-gray-50 dark:bg-gray-900">
	<aside id="sidebar" class="w-[280px] bg-white dark:bg-gray-800 p-6 border-r border-gray-200 dark:border-gray-700 h-[calc(100vh-80px)] sticky top-0 flex-shrink-0 overflow-y-auto transition-transform duration-300 max-lg:fixed max-lg:top-0 max-lg:left-0 max-lg:w-4/5 max-lg:max-w-[320px] max-lg:h-screen max-lg:z-[999] max-lg:shadow-xl max-lg:-translate-x-full">
		<div class="text-xs text-gray-600 dark:text-gray-400 mb-3">
			Signed in as <strong class="text-gray-900 dark:text-gray-100">{{.User.Username}}</strong>
		</div>
		<div class="space-y-2">
			<a href="/files" class="block px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors no-underline font-medium">
				ğŸ“ Files
			</a>
			<a href="/settings" class="block px-3 py-2 rounded-lg bg-gray-900 dark:bg-gray-600 text-white transition-colors no-underline font-medium">
				âš™ï¸ Settings
			</a>
			<form action="/logout" method="POST">
				<button type="submit" class="w-full text-left px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors font-medium">
					ğŸšª Logout
				</button>
			</form>
		</div>
	</aside>

	<main class="flex-1 p-6 max-w-4xl">
		<h1 class="text-3xl font-bold mb-6 text-gray-900 dark:text-gray-100">Settings</h1>

		<!-- Flash Messages -->
		{{if .Success}}
		<div class="p-4 rounded mb-4 border-l-4 bg-green-50 dark:bg-green-900/30 text-green-600 dark:text-green-400 border-green-600">
			{{.Success}}
		</div>
		{{end}}

		{{if .Error}}
		<div class="p-4 rounded mb-4 border-l-4 bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-400 border-red-600">
			{{.Error}}
		</div>
		{{end}}

		<!-- Appearance -->
		<div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-6">
			<h2 class="text-xl font-semibold mb-4 text-gray-900 dark:text-gray-100">Appearance</h2>
			<div class="flex items-center justify-between">
				<div>
					<label class="text-sm font-medium text-gray-900 dark:text-gray-100">Dark Mode</label>
					<p class="text-sm text-gray-600 dark:text-gray-400">Toggle between light and dark theme</p>
				</div>
				<button id="theme-toggle-settings" class="px-4 py-2 rounded-lg bg-gray-900 dark:bg-gray-600 text-white hover:bg-gray-700 dark:hover:bg-gray-500 transition-colors font-medium">
					<span class="dark:hidden">Enable Dark Mode ğŸŒ™</span>
					<span class="hidden dark:inline">Enable Light Mode â˜€ï¸</span>
				</button>
			</div>
	</div>

	<!-- Change Password -->
	<div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
		<h2 class="text-xl font-semibold mb-4 text-gray-900 dark:text-gray-100">Change Password</h2>
		<form method="POST" action="/settings/change-password">
			<input type="hidden" name="csrf_token" value="{{.CSRFToken}}">
			
			<div class="mb-4">
				<label for="current_password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Current Password</label>
				<input type="password" id="current_password" name="current_password" required 
					class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-900 dark:focus:ring-gray-400">
			</div>

			<div class="mb-4">
				<label for="new_password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">New Password</label>
				<input type="password" id="new_password" name="new_password" required minlength="8"
					class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-900 dark:focus:ring-gray-400">
				<p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Must be at least 8 characters</p>
			</div>

			<div class="mb-6">
				<label for="confirm_password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Confirm New Password</label>
				<input type="password" id="confirm_password" name="confirm_password" required minlength="8"
					class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-900 dark:focus:ring-gray-400">
			</div>

			<button type="submit" class="w-full bg-gray-900 dark:bg-gray-600 text-white py-2.5 rounded-lg font-medium hover:bg-gray-700 dark:hover:bg-gray-500 transition-colors">
				Change Password
			</button>
		</form>
	</div>
	</main>
</div>

<script>
	const themeToggleSettings = document.getElementById('theme-toggle-settings');
	if (themeToggleSettings) {
		themeToggleSettings.addEventListener('click', function() {
			if (document.documentElement.classList.contains('dark')) {
				document.documentElement.classList.remove('dark');
				localStorage.theme = 'light';
			} else {
				document.documentElement.classList.add('dark');
				localStorage.theme = 'dark';
			}
		});
	}
</script>
{{end}}
