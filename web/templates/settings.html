{{define "content"}}
{{template "flash_messages" .}}
<div class="min-h-[calc(100vh-80px)] bg-white dark:bg-gray-800">
	<main class="p-6 max-w-4xl mx-auto">
		<h1 class="text-3xl font-bold mb-6 text-gray-900 dark:text-gray-100">Settings</h1>

		<!-- Appearance -->
		<div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-6">
			<h2 class="text-xl font-semibold mb-4 text-gray-900 dark:text-gray-100">Appearance</h2>
			<div class="flex items-center justify-between">
				<div>
					<label class="text-sm font-medium text-gray-900 dark:text-gray-100">Dark Mode</label>
					<p class="text-sm text-gray-600 dark:text-gray-400">Toggle between light and dark theme</p>
				</div>
				<button id="theme-toggle-settings" class="flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-900 dark:bg-gray-600 text-white hover:bg-gray-700 dark:hover:bg-gray-500 transition-colors font-medium">
					<svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
						<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
					</svg>
					<svg id="sun-icon" class="hidden" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
						<circle cx="12" cy="12" r="5"></circle>
						<line x1="12" y1="1" x2="12" y2="3"></line>
						<line x1="12" y1="21" x2="12" y2="23"></line>
						<line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
						<line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
						<line x1="1" y1="12" x2="3" y2="12"></line>
						<line x1="21" y1="12" x2="23" y2="12"></line>
						<line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
						<line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
					</svg>
					<span id="theme-text">Enable Dark Mode</span>
				</button>
			</div>
	</div>

	<!-- Change Password -->
	<div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
		<h2 class="text-xl font-semibold mb-4 text-gray-900 dark:text-gray-100">Change Password</h2>
		<form method="POST" action="/settings/change-password">
			
			<div class="mb-4">
				<label for="current_password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Current Password</label>
				<input type="password" id="current_password" name="current_password" required
					autocomplete="current-password"
					class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-900 dark:focus:ring-gray-400">
			</div>

			<div class="mb-4">
				<label for="new_password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">New Password</label>
				<input type="password" id="new_password" name="new_password" required minlength="8"
					autocomplete="new-password"
					class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-900 dark:focus:ring-gray-400">
				<p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Must be at least 8 characters</p>
			</div>

			<div class="mb-6">
				<label for="confirm_password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Confirm New Password</label>
				<input type="password" id="confirm_password" name="confirm_password" required minlength="8"
					autocomplete="new-password"
					class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-900 dark:focus:ring-gray-400">
			</div>

			<button type="submit" class="w-full bg-gray-900 dark:bg-gray-600 text-white py-2.5 rounded-lg font-medium hover:bg-gray-700 dark:hover:bg-gray-500 transition-colors">
				Change Password
			</button>
		</form>
	</div>
	</main>
</div>

<script>
	const themeToggleSettings = document.getElementById('theme-toggle-settings');
	const moonIcon = document.getElementById('moon-icon');
	const sunIcon = document.getElementById('sun-icon');
	const themeText = document.getElementById('theme-text');

	function updateThemeButton() {
		if (document.documentElement.classList.contains('dark')) {
			moonIcon.classList.add('hidden');
			sunIcon.classList.remove('hidden');
			themeText.textContent = 'Enable Light Mode';
		} else {
			moonIcon.classList.remove('hidden');
			sunIcon.classList.add('hidden');
			themeText.textContent = 'Enable Dark Mode';
		}
	}

	// Set initial state
	updateThemeButton();

	if (themeToggleSettings) {
		themeToggleSettings.addEventListener('click', function() {
			if (document.documentElement.classList.contains('dark')) {
				document.documentElement.classList.remove('dark');
				localStorage.theme = 'light';
			} else {
				document.documentElement.classList.add('dark');
				localStorage.theme = 'dark';
			}
			updateThemeButton();
		});
	}
</script>
{{end}}
