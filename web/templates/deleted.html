{{define "content"}}
<div class="min-h-[calc(100vh-80px)] bg-white dark:bg-gray-800">
	<!-- Main Content -->
	<main class="p-8 max-lg:p-4">
		<div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6">
			<div>
				<h1 class="text-3xl font-bold text-gray-900 dark:text-gray-100">Deleted Items</h1>
				<p class="text-sm text-gray-600 dark:text-gray-400 mt-1">
					Items are permanently removed after {{.RetentionDays}} days
				</p>
			</div>
			
			<!-- Stats -->
			<div class="flex items-center gap-4">
				<div class="text-sm text-gray-600 dark:text-gray-400">
					<span class="font-medium text-gray-900 dark:text-gray-100">{{.TotalFiles}}</span> files,
					<span class="font-medium text-gray-900 dark:text-gray-100">{{.TotalFolders}}</span> folders
					({{formatBytes .TotalDeletedSize}})
				</div>
				{{if or .Files .Folders}}
				<form method="POST" action="/deleted/empty" onsubmit="return confirm('Are you sure you want to permanently delete ALL items? This cannot be undone.');">
					<button type="submit" class="flex items-center gap-2 px-4 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white transition-colors text-sm font-medium">
						<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
							<polyline points="3 6 5 6 21 6"></polyline>
							<path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
							<line x1="10" y1="11" x2="10" y2="17"></line>
							<line x1="14" y1="11" x2="14" y2="17"></line>
						</svg>
						Delete All
					</button>
				</form>
				{{end}}
			</div>
		</div>

		{{template "flash_messages" .}}

		{{if or .Files .Folders}}
		{{if .Folders}}
		<!-- Folders Section -->
		<div class="mb-6">
			<h2 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3">Folders</h2>
			<div class="flex flex-wrap gap-2">
				{{range .Folders}}
				<div class="flex items-center bg-gray-100 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 w-full sm:w-[280px]">
					<div class="flex items-center gap-2 px-3 py-2 flex-1 min-w-0">
						<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-yellow-500 dark:text-yellow-400 flex-shrink-0 opacity-50" aria-hidden="true">
							<path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
						</svg>
						<div class="flex-1 min-w-0">
							<span class="text-gray-900 dark:text-gray-100 font-medium truncate block" title="{{.Name}}">{{.Name}}</span>
							<span class="text-xs text-gray-500 dark:text-gray-400">{{.OriginalPath}} • expires in {{.ExpiresIn}}</span>
						</div>
					</div>
					<!-- Folder action buttons -->
					<div class="flex items-center gap-1 px-2 border-l border-gray-200 dark:border-gray-600">
						<form method="POST" action="/deleted/folders/{{.ID}}/restore" class="inline">
							<button type="submit" class="p-2 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors text-green-600 dark:text-green-400" title="Restore folder">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
									<polyline points="1 4 1 10 7 10"></polyline>
									<path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
								</svg>
							</button>
						</form>
						<form method="POST" action="/deleted/folders/{{.ID}}/delete" onsubmit="return confirm('Permanently delete this folder and all its contents? This cannot be undone.');" class="inline">
							<button type="submit" class="p-2 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors text-red-600 dark:text-red-400" title="Delete permanently">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
									<polyline points="3 6 5 6 21 6"></polyline>
									<path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
								</svg>
							</button>
						</form>
					</div>
				</div>
				{{end}}
			</div>
		</div>
		{{end}}

		{{if .Files}}
		<!-- Files Section -->
		<div>
			<h2 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3">Files</h2>
			<div class="overflow-x-auto">
				<table class="w-full border-collapse">
					<thead>
						<tr class="bg-gray-50 dark:bg-gray-700">
							<th class="text-left p-3 text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-600">Name</th>
							<th class="text-left p-3 text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-600 max-sm:hidden">Original Location</th>
							<th class="text-left p-3 text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-600 max-sm:hidden">Size</th>
							<th class="text-left p-3 text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-600 max-md:hidden">Expires In</th>
							<th class="text-right p-3 text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-600 w-24">Actions</th>
						</tr>
					</thead>
					<tbody>
					{{range .Files}}
					<tr class="hover:bg-gray-50 dark:hover:bg-gray-700/50">
						<td class="p-3 border-b border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 max-w-0">
							<div class="flex items-center gap-2 min-w-0">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-400 flex-shrink-0 opacity-50" aria-hidden="true">
									<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
									<polyline points="14 2 14 8 20 8"></polyline>
								</svg>
								<span class="truncate" title="{{.Filename}}">{{.Filename}}</span>
							</div>
						</td>
						<td class="p-3 border-b border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-400 max-sm:hidden">
							<span class="truncate block max-w-[200px]" title="{{.OriginalLogicalPath}}">{{.OriginalLogicalPath}}</span>
						</td>
						<td class="p-3 border-b border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-400 max-sm:hidden">{{formatBytes .FileSize}}</td>
						<td class="p-3 border-b border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-400 max-md:hidden">{{.ExpiresIn}}</td>
						<td class="p-3 border-b border-gray-200 dark:border-gray-700 text-right">
							<div class="flex items-center justify-end gap-1">
								<form method="POST" action="/deleted/files/{{.ID}}/restore" class="inline">
									<button type="submit" class="p-2 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors text-green-600 dark:text-green-400" title="Restore file" aria-label="Restore file">
										<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
											<polyline points="1 4 1 10 7 10"></polyline>
											<path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
										</svg>
									</button>
								</form>
								<form method="POST" action="/deleted/files/{{.ID}}/delete" onsubmit="return confirm('Permanently delete this file? This cannot be undone.');" class="inline">
									<button type="submit" class="p-2 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors text-red-600 dark:text-red-400" title="Delete permanently" aria-label="Delete permanently">
										<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
											<polyline points="3 6 5 6 21 6"></polyline>
											<path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
										</svg>
									</button>
								</form>
							</div>
						</td>
					</tr>
					{{end}}
					</tbody>
				</table>
			</div>

			<!-- Pagination -->
			{{if gt .TotalPages 1}}
			<div class="flex justify-between items-center mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600">
				{{if gt .Page 1}}
					<a href="/deleted?page={{.Page | add -1}}" class="bg-gray-900 dark:bg-gray-600 text-white px-4 py-2 rounded border border-gray-700 dark:border-gray-500 hover:bg-gray-700 dark:hover:bg-gray-500">← Previous</a>
				{{else}}
					<span class="px-4 py-2 rounded border border-gray-300 dark:border-gray-600 opacity-40 cursor-not-allowed text-gray-500 dark:text-gray-400">← Previous</span>
				{{end}}

				<span class="text-gray-600 dark:text-gray-400 font-medium">Page {{.Page}} of {{.TotalPages}}</span>

				{{if lt .Page .TotalPages}}
					<a href="/deleted?page={{.Page | add 1}}" class="bg-gray-900 dark:bg-gray-600 text-white px-4 py-2 rounded border border-gray-700 dark:border-gray-500 hover:bg-gray-700 dark:hover:bg-gray-500">Next →</a>
				{{else}}
					<span class="px-4 py-2 rounded border border-gray-300 dark:border-gray-600 opacity-40 cursor-not-allowed text-gray-500 dark:text-gray-400">Next →</span>
				{{end}}
			</div>
			{{end}}
		</div>
		{{end}}
		{{else}}
		<div class="text-center py-12">
			<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="text-gray-300 dark:text-gray-600 mx-auto mb-4" aria-hidden="true">
				<polyline points="3 6 5 6 21 6"></polyline>
				<path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
			</svg>
			<p class="text-gray-600 dark:text-gray-400 text-lg">No deleted items</p>
			<p class="text-gray-500 dark:text-gray-500 text-sm mt-1">Deleted files and folders will appear here</p>
		</div>
		{{end}}
	</main>
</div>
{{end}}
